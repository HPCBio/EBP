# Tell-Read

It is a set of pipeline processes that takes as input the sequencing output from an NGS
sequencing instrument and generates linked-read FASTQ data, as well as QC reports.

# Dependencies

- tellread v1.0.2
- singularity v3.4.1 or higher

# Pre-processing

Even though the tool can demultiplex bcl files generated by Illumina; 
we are going to assume that the input is in fastq format and that there are three files per sample
as described in step1

# Setup

We need to have the input files in a specified location that Singularity can access

We also need to create an empty folder called genome

<pre>

cd ~/

ln -s /full/apth/EarthBioGenome/raw_tellseq/ ~/raw_tellseq

mkdir ~/genome

</pre>

We also need to setup global environment variables with the export line or by including them in your bashrc file


<pre>

$ module load singularity/3.4.1

$ export PATH=${PATH}:/home/a-m/grendon/TELL-Seq/v1.0.2/tellread-release/

</pre>


# Run Tellread

The run_tellread_fq.sh script is a pipeline that trims adaptors a then error-corrects barcodes.

Notice how the input files are specified in the command: reads and in R1 and R3; barcodes are in R2.

<pre>

$ run_tellread_fq.sh \
-i1 raw_tellseq/EB14_S2_L004_R2_001.fastq.gz \
-r1 raw_tellseq/EB14_S2_L004_R1_001.fastq.gz \
-r2 raw_tellseq/EB14_S2_L004_R3_001.fastq.gz \
-m "NovaSeq" \
-o $PWD/EB14_nobc  \
-g "NONE" \
-f $PWD/genomes 2>&1  > tellread_EB14_nobc.log &

</pre>

Where:


- -i1 This is a required parameter. It specifies the I1 read file in fastq.gz format.

- -i2 This is an optional parameter. It specifies the sample index I2 read file in fastq.gz format.
If there is only one sample in the run dataset, this parameter is not needed.

- -r1 This is a required parameter. It specifies the R1 read file in fastq.gz format.

- -r2 This is an optional parameter. It specifies the R2 read file in fastq.gz format in a pair-end
run.

- -m This parameter specifies machine type for the sequencer. The supported values are:
“MiniSeq”, “MiSeq”, “HiSeq”, “NextSeq”, and “NovaSeq”. This parameter is needed if the
dataset is not sample-demultiplexed. If there is only one sample the dataset, this
parameter is not needed.

- -o This is a required parameter. It specifies the output directory for analysis results.

- -f This is a required parameter. It specifies the directory that genome reference files are
located.

- -s This parameter specifies a comma-delimited sample index list. See Sample Index Names
below. If there is only one sample in the dataset, this parameter is not needed. In the
output, result is identified by the default sample name T500.

- -g This is a comma-delimited genome reference list. For example, DH10B, Arab, Fly. These
reference names are used to retrieve specific genome FASTA files. Detailed steps on to
make these reference files will be discussed in the Prepare Genome Reference Directory
section below. Note: No spaces in between genome names.

# Outputs

After the cmd finishes, it should create these subfolders in the output path:

-    0_fastq/ contains a text file with the total readcounts

-    1_demult/ has results of demultiplexing and trimming

-    2_barcode_indiv/ has results of error correction

-    benchmarks/ has more results of error correction

-    download/ has summary reports

-    Full/ has the output files. The names are really long though as shown below.


Our Example:

<pre>

$ ls /home/a-m/grendon/EB14_nobc/Full/
EB14_nobc_I1_T500.fastq.gz.corrected.fastq.err_barcode_removed.fastq.gz
EB14_nobc_I1_T500.fastq.gz.corrected.fastq.err_barcode_removed.fastq.log
EB14_nobc_I1_T500.fastq.gz.corrected.log
EB14_nobc_R1_T500.fastq.gz.corrected.fastq.err_barcode_removed.fastq.gz
EB14_nobc_R2_T500.fastq.gz.corrected.fastq.err_barcode_removed.fastq.gz
fastqc/

</pre>


The forward reads go in this file EB14_nobc_R1_T500.fastq.gz.corrected.fastq.err_barcode_removed.fastq.gz
The reverse reads go in this file EB14_nobc_R2_T500.fastq.gz.corrected.fastq.err_barcode_removed.fastq.gz
The TellSeq barcodes go in this file EB14_nobc_I1_T500.fastq.gz.corrected.fastq.err_barcode_removed.fastq.gz

